hostname R1
!
username admin privilege 15 role network-admin secret admin
aaa authentication login default local
!
spanning-tree mode mstp
!
tunnel-ribs
tunnel-rib system-tunnel-rib
source-protocol nexthop-group
source-protocol rsvp-ler
source-protocol bgp labeled-unicast
source-protocol static
source-protocol ldp
source-protocol isis flex-algo preference 50
source-protocol isis segment-routing
!
vrf instance v1
rd 1:1
!
interface Ethernet1
description to R2 E1
no switchport
ip address 10.0.12.1/24
isis enable 1
isis bfd
isis network point-to-point
isis fast-reroute ti-lfa mode link-protection
!
interface Ethernet2
description to R6 E3
no switchport
ip address 10.0.16.1/24
isis enable 1
isis bfd
isis network point-to-point
isis fast-reroute ti-lfa mode link-protection
!
interface Ethernet3
description to R3 E3
no switchport
ip address 10.0.13.1/24
isis enable 1
isis bfd
isis network point-to-point
isis fast-reroute ti-lfa mode link-protection
!
interface Ethernet4
no switchport
vrf v1
ip address 10.100.19.1/24
!
interface Loopback0
ip address 10.0.0.1/32
node-segment ipv4 index 1001
isis enable 1
isis passive
!
interface Loopback1
ip address 10.1.1.1/32
node-segment ipv4 index 11
isis enable 1
isis passive
!
interface Management1
ip address 192.168.20.201/24
!
ip routing
ip routing vrf v1
!
mpls ip
!
mpls label range isis-sr 400000 10000
!
router bgp 65100
maximum-paths 128
neighbor INTERNAL peer group
neighbor INTERNAL remote-as 65100
neighbor INTERNAL update-source Loopback0
neighbor INTERNAL bfd
neighbor INTERNAL rib-in pre-policy retain all
neighbor INTERNAL route-reflector-client
neighbor INTERNAL send-community extended
neighbor 10.0.0.2 peer group INTERNAL
neighbor 10.0.0.3 peer group INTERNAL
neighbor 10.0.0.4 peer group INTERNAL
neighbor 10.0.0.5 peer group INTERNAL
neighbor 10.0.0.6 peer group INTERNAL
!
address-family evpn
neighbor default encapsulation mpls next-hop-self source-interface Loopback0
neighbor INTERNAL activate
!
address-family ipv4 labeled-unicast
neighbor INTERNAL activate
neighbor INTERNAL next-hop-self source-interface Loopback0
network 10.0.0.1/32
network 10.1.1.1/32
!
vrf v1
rd 1:1
route-target import evpn 1:1
route-target export evpn 1:1
neighbor 10.100.19.9 remote-as 65000
!
address-family ipv4
neighbor 10.100.19.9 activate
!
router isis 1
net 49.0001.1111.1111.1111.00
is-type level-2
!
address-family ipv4 unicast
fast-reroute ti-lfa mode node-protection
!
segment-routing mpls
router-id 10.0.0.1
no shutdown
adjacency-segment allocation sr-peers backup-eligible
